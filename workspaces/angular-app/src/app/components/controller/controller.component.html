<div #mfContainer class="mf-container">
	<app-settings #settings [activeBank]="activeBank()" [selectedButtons]="selectedButtons()"
		[selectedEncoders]="selectedEncoders()" [(mode)]="mode"
		[(rgbActive)]="rgbActive" [(indicatorActive)]="indicatorActive" />

	@if (controllerConfigService.controllerData().bank) {
	<div class="title" [ngClass]="{'inactive': !midiService.midiFighterAvailable()}">
		<h2>
			@if (mode() !== 'edit') {
			{{ controllerConfigService.controllerData()!.title }}
			} @else if (mode() === 'edit') {
			<input [(ngModel)]="controllerConfigService.controllerData()!.title" />
			}
		</h2>
		<div class="cable">
			<div>x</div>
			<img src="./assets/usb-cable.svg" />
		</div>
	</div>

	<div class="sub-title">
		<h3>Bank {{activeBank() + 1}}</h3>
		<img src="./assets/shift.svg" [ngClass]="{'active': mode() === 'edit'}"
			(click)="shiftActive.set(!shiftActive())" />
	</div>

	@if (settings.showMessage()) {
	{{message()?.actionType}} ch: {{message()?.channel}} cc: {{message()?.cc}} velocity: {{message()?.velocity}}
	}

	<div class="controller">
		<app-side [(selectedButtons)]="selectedButtons" [mode]="mode()"
			[buttons]="controllerConfigService.controllerData()![actionType()][activeBank()].leftSide" side="left" [(shiftActive)]="shiftActive"
			[(activeBank)]="activeBank" />
		<div class="encoders" [ngClass]="{ active: mode() === 'lighting' }">
			@for (
			encoder of controllerConfigService.controllerData()![actionType()][activeBank()].encoder;
			let idx = $index;
			track encoder.cc
			) {
			<app-encoder [index]="idx" [(selectedEncoders)]="selectedEncoders" [mode]="mode()" [encoder]="encoder"
				[rgbActive]="rgbActive()" [indicatorActive]="indicatorActive()" [activeBank]="activeBank()" />
			}
		</div>
		<app-side [(selectedButtons)]="selectedButtons" [mode]="mode()"
			[buttons]="controllerConfigService.controllerData()![actionType()][activeBank()].rightSide" side="right"
			[(activeBank)]="activeBank" />
	</div>
	}
</div>